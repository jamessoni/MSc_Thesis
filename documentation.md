## Documentation:</br>
This document provides brief descriptions of each notebook, what it entails and some of the key functions that it presents.

**Load_data.ipynb**:
Loading/reading in of the .VTU files with respect to the data wanting to be extracted. 

#### loadvtufile(): </br>
The function presents a method to read in and collate the data for a particular field. Within this thesis, for spatio-temporal predictions, with CO<sub>2</sub>, and velocity being the fields of interest. </br>
Function returns an array and a concatenated snapshot matrix is formed </br>dim(X) = (410, 148,906*4).</br></br>

**POD_Compression.ipynb**:
Dimensionality reduction by method of POD/PCA.

Contains use of embedded functionality within the machine learning library, scikit-learn. Enables the reduction to 43 POD coefficients.

**Extract_Sensors.ipynb**:
Aims to obtain the CO<sub>2</sub> sensor values at every time-step with reference to interpolating the surrounding nodes.

Returns an array of (#Time-levels, #Sensors)

The file concatenates the scaled arrays of the POD coefficients with the sensor locations.

**Enhanced_Train_GAN.ipynb**:
Sees the implementation of training a Deep Convolutional GAN (DCGAN). 

The generator takes in as input a latent space of 50 consisting of random noise, with it adversarially training against the discriminator to produce more realistic samples. As a result the adversarially trained neural networks enable the generator to map the to the data distribution of interest.

Generator return an output shape of (9, 50). 

**PredGAN_Enhanced**:
The file aims to step in time, predicting representative reduced order variables (POD coefficients) and embedded sensor values through means of convergence.
Initial prediction is produced through minimising the loss with known solutions (initial conditions). 

#### concat_timesteps(): </br>
Function takes in a 2D array, concatenating 9 time levels in a single segment and skipping time-levels if required. </br>
Function return an array.

#### mse_loss(): </br>
Takes in a 2D array, determining the mean square error between the output generated by the generator of the GAN and a batch of the training set.</br>
Return mean square error.

#### opt_step(): </br>
Optimisation step: </br>
Finds the loss between the first n-1 generated values and n-1 real values with the nth value as the prediction.
If training for 9 time levels, it finds the loss between the first 8 outputs from the generator and 8 real. Applies the gradient calculated from optimizer.</br>
Returns mean square error loss.

#### optimize_coding(): </br>
Function calls the opt_step() function.
Returns the optimised input latent values that generate the desired output.

**DA-PredAN_Enhanced.ipynb**:
Data Assimilates observations using both forward and backward marches in time to define post and pre-observation behaviour.
Due to enhanced training, observations can be applied minimising loss directly against generated sensor location values. This reduces the need to form primitive variables.

#### enhanced_sse_loss():
Calculates the loss generated from the generator output with reference to the training dataset.</br>
Returns the loss

#### obse_sse_loss():
Calculates the loss (mismatch) from only the sensor locations. </br>
Returns the loss.

#### optimize_coding_forward_only() / optimize_coding_LastForward:
Performing a signle forward pass, optimising the latent values from the enhanced loss.
Returns optimised latent values & loss.

#### optimize_coding_forward
Performs a forward pass optimising the latent values with respect to the enhanced and observation loss.
Returns optimised latent values & loss.

#### optimize_coding_backward
Time steps backward in time, also optimising the latent values with respect to enhanced and observation losses.
Returns optimised latent values & loss.

Main test cases carried out: </br>
(1) Validation of prediction against Fluidity CFD
(2) Convergence when predicting in time beyond trained dataset.
(3) Use of experimental (real) dataset. Analysing convergence of the predictive models (PredGAN, DA-PredGAN) against experimental data.

Spatio-temporal plots are evaluated within the report and produced within the Results.ipynb notebook. Further isosurface plots presents the evolution of the spread across the entirety of the enclosed space.